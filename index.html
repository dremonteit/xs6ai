<!DOCTYPE html><!--  This site was created in Webflow. https://webflow.com  --><!--  Last Published: Wed Feb 12 2025 22:12:33 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="67a7d5201f8561b1ffec5f13" data-wf-site="67a7d5201f8561b1ffec5f14">
<head>
  <meta charset="utf-8">
  <title>XS6 Ai</title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/xs6-ai.webflow.css" rel="stylesheet" type="text/css">
  <style>@media (max-width:991px) and (min-width:768px) {html.w-mod-js:not(.w-mod-ix) [data-w-id="ce2ea5a9-2ff8-af83-75af-88e5dd9c4857"] {display:none;opacity:0;}}@media (max-width:767px) and (min-width:480px) {html.w-mod-js:not(.w-mod-ix) [data-w-id="ce2ea5a9-2ff8-af83-75af-88e5dd9c4857"] {display:none;opacity:0;}}@media (max-width:479px) {html.w-mod-js:not(.w-mod-ix) [data-w-id="ce2ea5a9-2ff8-af83-75af-88e5dd9c4857"] {display:none;opacity:0;}}</style>
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Figtree:regular,500,600,700","Figtree:300"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <div class="page-wrapper">
    <div class="global-styles w-embed">
      <style>
/*width*/
*::-webkit-scrollbar{
	width:4px;
  height: 4px;
}
/*track*/
*::-webkit-scrollbar-track, {
background: var(--swatch--primary);
border-width:4px;
border-style:none;
}
/*thumb*/
*::-webkit-scrollbar-thumb {
background: #4B4B5B;
border-width:0px;
border-radius: 8px;
border-style:none;
}
.sources-list::-webkit-scrollbar{
 width: 0px;
 height: 4px;
}
.sources-list::-webkit-scrollbar-track, {
border-width:4px;
border-style:none;
}
/* Set color style to inherit */
.inherit-color * {
    color: inherit;
}
/* Focus state style for keyboard navigation for the focusable elements */
*[tabindex]:focus-visible,
  input[type="file"]:focus-visible {
   outline: 0.125rem solid #4d65ff;
   outline-offset: 0.125rem;
}
/* Get rid of top margin on first element in any rich text element */
.w-richtext > :not(div):first-child, .w-richtext > div:first-child > :first-child {
  margin-top: 0 !important;
}
/* Get rid of bottom margin on last element in any rich text element */
.w-richtext>:last-child, .w-richtext ol li:last-child, .w-richtext ul li:last-child {
	margin-bottom: 0 !important;
}
/* Prevent all click and hover interaction with an element */
.pointer-events-off {
	pointer-events: none;
}
/* Enables all click and hover interaction with an element */
.pointer-events-on {
  pointer-events: auto;
}
/* Create a class of .div-square which maintains a 1:1 dimension of a div */
.div-square::after {
	content: "";
	display: block;
	padding-bottom: 100%;
}
/* Make sure containers never lose their center alignment */
.container-medium,.container-small, .container-large {
	margin-right: auto !important;
  margin-left: auto !important;
}
/* 
Make the following elements inherit typography styles from the parent and not have hardcoded values. 
Important: You will not be able to style for example "All Links" in Designer with this CSS applied.
Uncomment this CSS to use it in the project. Leave this message for future hand-off.
*/
/*
a,
.w-input,
.w-select,
.w-tab-link,
.w-nav-link,
.w-dropdown-btn,
.w-dropdown-toggle,
.w-dropdown-link {
  color: inherit;
  text-decoration: inherit;
  font-size: inherit;
}
*/
/* Apply "..." after 3 lines of text */
.text-style-3lines {
	display: -webkit-box;
	overflow: hidden;
	-webkit-line-clamp: 3;
	-webkit-box-orient: vertical;
}
/* Apply "..." after 2 lines of text */
.text-style-2lines {
	display: -webkit-box;
	overflow: hidden;
	-webkit-line-clamp: 2;
	-webkit-box-orient: vertical;
}
/* Adds inline flex display */
.display-inlineflex {
  display: inline-flex;
}
/* These classes are never overwritten */
.hide {
  display: none !important;
}
@media screen and (max-width: 991px) {
    .hide, .hide-tablet {
        display: none !important;
    }
}
  @media screen and (max-width: 767px) {
    .hide-mobile-landscape{
      display: none !important;
    }
}
  @media screen and (max-width: 479px) {
    .hide-mobile{
      display: none !important;
    }
}
.margin-0 {
  margin: 0rem !important;
}
.padding-0 {
  padding: 0rem !important;
}
.spacing-clean {
padding: 0rem !important;
margin: 0rem !important;
}
.margin-top {
  margin-right: 0rem !important;
  margin-bottom: 0rem !important;
  margin-left: 0rem !important;
}
.padding-top {
  padding-right: 0rem !important;
  padding-bottom: 0rem !important;
  padding-left: 0rem !important;
}
.margin-right {
  margin-top: 0rem !important;
  margin-bottom: 0rem !important;
  margin-left: 0rem !important;
}
.padding-right {
  padding-top: 0rem !important;
  padding-bottom: 0rem !important;
  padding-left: 0rem !important;
}
.margin-bottom {
  margin-top: 0rem !important;
  margin-right: 0rem !important;
  margin-left: 0rem !important;
}
.padding-bottom {
  padding-top: 0rem !important;
  padding-right: 0rem !important;
  padding-left: 0rem !important;
}
.margin-left {
  margin-top: 0rem !important;
  margin-right: 0rem !important;
  margin-bottom: 0rem !important;
}
.padding-left {
  padding-top: 0rem !important;
  padding-right: 0rem !important;
  padding-bottom: 0rem !important;
}
.margin-horizontal {
  margin-top: 0rem !important;
  margin-bottom: 0rem !important;
}
.padding-horizontal {
  padding-top: 0rem !important;
  padding-bottom: 0rem !important;
}
.margin-vertical {
  margin-right: 0rem !important;
  margin-left: 0rem !important;
}
.padding-vertical {
  padding-right: 0rem !important;
  padding-left: 0rem !important;
}
/* Apply "..." at 100% width */
.truncate-width { 
		width: 100%; 
    white-space: nowrap; 
    overflow: hidden; 
    text-overflow: ellipsis; 
}
/* Removes native scrollbar */
.no-scrollbar {
    -ms-overflow-style: none;
    overflow: -moz-scrollbars-none; 
}
.no-scrollbar::-webkit-scrollbar {
    display: none;
}
.form-button:disabled {
	background-color: var(--swatch--disabled)
}
</style>
      <style>
.loader {
  aspect-ratio: 1;
  border-radius: 50%;
  --_m: 
    conic-gradient(#0000 10%,#000),
    linear-gradient(#000 0 0) content-box;
  -webkit-mask: var(--_m);
          mask: var(--_m);
  -webkit-mask-composite: source-out;
          mask-composite: subtract;
  animation: l3 .75s infinite linear;
}
@keyframes l3 {to{transform: rotate(1turn)}
}
.thinking-block.is-collapsed  .icon-1x1.is-arrow{
	transform: rotate(180deg);
}
.thinking-block.is-collapsed .thinking-content-panel {
	max-height: 0px;
}
</style>
    </div>
    <div class="shell2_wrapper">
      <div data-animation="over-left" class="sidebar_component w-nav" data-easing2="ease" fs-scrolldisable-element="smart-nav" data-easing="ease" data-collapse="medium" data-w-id="ce2ea5a9-2ff8-af83-75af-88e5dd9c47e7" role="banner" data-duration="400">
        <div class="sidebar1_container">
          <a href="#" class="sidebar1_logo-link w-inline-block"><img src="images/Xs6.png" loading="lazy" sizes="100vw" srcset="images/Xs6-p-500.png 500w, images/Xs6-p-800.png 800w, images/Xs6-p-1080.png 1080w, images/Xs6-p-1600.png 1600w, images/Xs6-p-2000.png 2000w, images/Xs6.png 2048w" alt="" class="sidebar1_logo"></a>
          <nav role="navigation" class="sidebar1_menu w-nav-menu">
            <div class="sidebar1_menu-wrapper">
              <div class="sidebar1_logo-wrapper-tablet">
                <a href="#" class="sidebar1_logo-link-tablet w-inline-block"><img src="images/company-logo.svg" loading="lazy" alt="" class="sidebar1_logo"></a>
                <div class="sidebar1_close-mobile">
                  <div class="sidebar1_menu-button w-nav-button">
                    <div class="icon-embed-small w-embed"><svg width="100%" height="100%" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17.1266 16.773L16.7729 17.1266C16.5777 17.3218 16.2611 17.3218 16.0658 17.1266L12 13.0607L7.9341 17.1265C7.73888 17.3218 7.42229 17.3218 7.22702 17.1265L6.87347 16.773C6.6782 16.5777 6.6782 16.2612 6.87347 16.0659L10.9394 12L6.87347 7.93413C6.6782 7.73891 6.6782 7.42232 6.87347 7.22705L7.22702 6.8735C7.42228 6.67824 7.73888 6.67824 7.9341 6.8735L12 10.9394L16.0658 6.8735C16.2611 6.67824 16.5777 6.67824 16.7729 6.8735L17.1266 7.22705C17.3218 7.42231 17.3218 7.73891 17.1266 7.93413L13.0607 12L17.1266 16.0659C17.3218 16.2612 17.3218 16.5777 17.1266 16.773Z" fill="currentColor"></path>
                      </svg></div>
                  </div>
                </div>
              </div>
              <div class="sidebar1_menu-top">
                <a href="#" class="sidebar1_link w-inline-block">
                  <div class="sidebar1_link-wrapper">
                    <div class="icon-embed-xsmall w-embed"><svg width="100%" height="100%" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2.99979 13H3.99979V20C3.99979 21.103 4.89679 22 5.99979 22H17.9998C19.1028 22 19.9998 21.103 19.9998 20V13H20.9998C21.1975 12.9999 21.3908 12.9412 21.5552 12.8314C21.7197 12.7215 21.8478 12.5653 21.9235 12.3826C21.9991 12.1999 22.0189 11.9989 21.9804 11.8049C21.9418 11.611 21.8466 11.4328 21.7068 11.293L12.7068 2.29296C12.614 2.20001 12.5038 2.12627 12.3825 2.07596C12.2612 2.02565 12.1311 1.99976 11.9998 1.99976C11.8685 1.99976 11.7384 2.02565 11.6171 2.07596C11.4958 2.12627 11.3856 2.20001 11.2928 2.29296L2.29279 11.293C2.15298 11.4328 2.05777 11.611 2.0192 11.8049C1.98064 11.9989 2.00044 12.1999 2.07611 12.3826C2.15178 12.5653 2.27992 12.7215 2.44433 12.8314C2.60874 12.9412 2.80204 12.9999 2.99979 13ZM9.99979 20V15H13.9998V20H9.99979ZM11.9998 4.41396L17.9998 10.414L18.0008 20H15.9998V15C15.9998 13.897 15.1028 13 13.9998 13H9.99979C8.89679 13 7.99979 13.897 7.99979 15V20H5.99979V10.414L11.9998 4.41396Z" fill="currentColor"></path>
                      </svg></div>
                    <div>Home</div>
                  </div>
                </a>
                <a href="#" class="sidebar1_link w-inline-block">
                  <div class="sidebar1_link-wrapper">
                    <div class="icon-embed-xsmall w-embed"><svg width="100%" height="100%" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M22.0001 7.99899C21.9999 7.82052 21.9519 7.64535 21.8612 7.49166C21.7705 7.33798 21.6402 7.21137 21.4841 7.12499L12.4621 2.12499C12.3138 2.04332 12.1473 2.00049 11.9781 2.00049C11.8088 2.00049 11.6423 2.04332 11.4941 2.12499L2.51607 7.08499C2.3601 7.17136 2.23006 7.29785 2.13941 7.45136C2.04876 7.60487 2.0008 7.77983 2.00049 7.95811C2.00018 8.13639 2.04754 8.31151 2.13767 8.46534C2.22779 8.61916 2.3574 8.7461 2.51307 8.83299L11.5351 13.873C11.6836 13.9564 11.8511 14.0004 12.0214 14.0005C12.1918 14.0007 12.3594 13.9571 12.5081 13.874L21.4861 8.87399C21.642 8.78727 21.7719 8.6604 21.8623 8.50654C21.9527 8.35268 22.0002 8.17744 22.0001 7.99899ZM12.0231 11.854L5.06007 7.96499L11.9771 4.14299L18.9411 8.00199L12.0231 11.854Z" fill="currentColor"></path>
                        <path d="M20.515 11.126L12 15.856L3.48504 11.126L2.51404 12.874L11.514 17.874C11.6626 17.9565 11.8296 17.9997 11.9995 17.9997C12.1694 17.9997 12.3365 17.9565 12.485 17.874L21.485 12.874L20.515 11.126Z" fill="currentColor"></path>
                        <path d="M20.515 15.126L12 19.856L3.48504 15.126L2.51404 16.874L11.514 21.874C11.6626 21.9565 11.8296 21.9997 11.9995 21.9997C12.1694 21.9997 12.3365 21.9565 12.485 21.874L21.485 16.874L20.515 15.126Z" fill="currentColor"></path>
                      </svg></div>
                    <div>Challenges &amp; Quests</div>
                  </div>
                </a>
                <a href="#" class="sidebar1_link w-inline-block">
                  <div class="sidebar1_link-wrapper">
                    <div class="icon-embed-xsmall w-embed"><svg width="100%" height="100%" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19.903 8.586C19.8556 8.47747 19.7892 8.37825 19.707 8.293L13.707 2.293C13.6217 2.21078 13.5225 2.14441 13.414 2.097C13.384 2.083 13.352 2.075 13.32 2.064C13.2363 2.03553 13.1492 2.01837 13.061 2.013C13.04 2.011 13.021 2 13 2H6C4.897 2 4 2.897 4 4V20C4 21.103 4.897 22 6 22H18C19.103 22 20 21.103 20 20V9C20 8.979 19.989 8.96 19.987 8.938C19.9821 8.84972 19.9649 8.76255 19.936 8.679C19.926 8.647 19.917 8.616 19.903 8.586ZM16.586 8H14V5.414L16.586 8ZM6 20V4H12V9C12 9.26522 12.1054 9.51957 12.2929 9.70711C12.4804 9.89464 12.7348 10 13 10H18L18.002 20H6Z" fill="currentColor"></path>
                        <path d="M8 12H16V14H8V12ZM8 16H16V18H8V16ZM8 8H10V10H8V8Z" fill="currentColor"></path>
                      </svg></div>
                    <div>Integrations</div>
                  </div>
                </a>
              </div>
              <div class="sidebar1_menu-bottom">
                <div class="line-divider"></div>
                <div class="sidebar1_link-list"></div>
                <div class="line-divider"></div>
                <div class="sidebar1_account">
                  <div class="sidebar1_avatar">
                    <div id="w-node-ce2ea5a9-2ff8-af83-75af-88e5dd9c483e-ffec5f13" class="sidebar1_avatar-image-wrapper"><img src="images/Xs6.png" loading="lazy" sizes="100vw" srcset="images/Xs6-p-500.png 500w, images/Xs6-p-800.png 800w, images/Xs6-p-1080.png 1080w, images/Xs6-p-1600.png 1600w, images/Xs6-p-2000.png 2000w, images/Xs6.png 2048w" alt="" class="sidebar1_avatar-image"></div>
                    <div id="w-node-ce2ea5a9-2ff8-af83-75af-88e5dd9c4840-ffec5f13" class="sidebar1_avatar-text-wrapper">
                      <div class="text-size-small text-weight-medium">Name Surname</div>
                      <div class="text-size-small">hello@x20vision.io</div>
                    </div>
                  </div>
                  <div data-hover="false" data-delay="200" data-w-id="ce2ea5a9-2ff8-af83-75af-88e5dd9c4845" class="sidebar1_dropdown w-dropdown">
                    <div class="sidebar1_dropdown-toggle w-dropdown-toggle"></div>
                    <nav style="-webkit-transform:translate3d(0, 3rem, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-moz-transform:translate3d(0, 3rem, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-ms-transform:translate3d(0, 3rem, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);transform:translate3d(0, 3rem, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);opacity:0" class="sidebar1_dropdown-list w-dropdown-list">
                      <a href="#" class="sidebar1_dropdown-link w-dropdown-link">My Profile</a>
                      <a href="#" class="sidebar1_dropdown-link w-dropdown-link">Profile Settings</a>
                      <div class="sidebar1_dropdown-divider"></div>
                      <a href="#" class="sidebar1_dropdown-link w-dropdown-link">Log Out</a>
                    </nav>
                  </div>
                </div>
              </div>
            </div>
          </nav>
          <div class="sidebar1_menu-button w-nav-button">
            <div class="menu-icon">
              <div class="menu-icon_line-top"></div>
              <div class="menu-icon_line-middle">
                <div class="menu-icon_line-middle-inner"></div>
              </div>
              <div class="menu-icon_line-bottom"></div>
            </div>
          </div>
        </div>
        <div data-w-id="ce2ea5a9-2ff8-af83-75af-88e5dd9c4857" class="sidebar1_background-layer"></div>
      </div>
      <main class="shell_main-wrapper">
        <div class="section_shell2-layout">
          <div class="padding-horizontal padding-medium">
            <div>
              <div class="padding-vertical padding-large">
                <div class="shell">
                  <div data-el="shell-main" class="shell-main">
                    <div class="container-medium">
                      <div class="header">
                        <h1>Welcome to XS6</h1>
                        <p>How can I help you today ?</p>
                      </div>
                      <div class="form-block-main w-form">
                        <form id="email-form-2" name="email-form-2" data-name="Email Form 2" method="get" data-wf-page-id="67a7d5201f8561b1ffec5f13" data-wf-element-id="856af6af-5128-dd06-5348-4e61171cdb7b">
                          <div class="input-clear"><input class="form-main-input w-input" maxlength="256" data-el="prompt" name="name" data-name="Name" placeholder="Ask me anything" type="text" id="name"><button data-el="generate" type="button" class="form-button">
                              <div class="icon-1 w-embed"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewbox="0 0 15 14" fill="none">
                                  <path d="M13.1857 6.99411C13.1861 7.15 13.1449 7.30318 13.0662 7.43778C12.9876 7.57239 12.8744 7.68354 12.7384 7.75973L3.5558 13.0103C3.42387 13.0851 3.27488 13.1246 3.12322 13.1251C2.98335 13.1248 2.84559 13.091 2.72149 13.0265C2.59738 12.962 2.49055 12.8687 2.40994 12.7544C2.32933 12.6401 2.2773 12.5082 2.2582 12.3696C2.2391 12.2311 2.25349 12.0899 2.30017 11.9581L3.79587 7.58583C3.81061 7.54257 3.83853 7.50501 3.8757 7.47843C3.91288 7.45185 3.95744 7.43758 4.00314 7.43762H7.93572C7.99569 7.43775 8.05506 7.42555 8.11012 7.40178C8.16518 7.378 8.21477 7.34316 8.25579 7.29941C8.29682 7.25566 8.32842 7.20395 8.34862 7.14748C8.36882 7.091 8.37719 7.03098 8.37322 6.97114C8.3633 6.85864 8.31124 6.75404 8.22748 6.67829C8.14372 6.60253 8.03443 6.56122 7.9215 6.56262H4.00697C3.96134 6.5627 3.91682 6.54851 3.87965 6.52204C3.84249 6.49556 3.81453 6.45812 3.7997 6.41497L2.29908 2.03997C2.24064 1.87232 2.23458 1.69087 2.28171 1.5197C2.32883 1.34853 2.42691 1.19575 2.56292 1.08163C2.69892 0.967522 2.86643 0.897483 3.04318 0.880818C3.21993 0.864152 3.39758 0.901647 3.55252 0.988326L12.74 6.23231C12.8752 6.3084 12.9876 6.41904 13.066 6.5529C13.1443 6.68675 13.1856 6.83902 13.1857 6.99411Z" fill="currentColor"></path>
                                </svg></div>
                            </button></div>
                          <div class="form_options">
                            <a href="#" class="options w-inline-block">
                              <div data-val="option-value">Translate this sentence for me</div>
                            </a>
                            <a href="#" class="options w-inline-block">
                              <div data-val="option-value">Tell me a joke</div>
                            </a>
                            <a href="#" class="options w-inline-block">
                              <div data-val="option-value">Summarize the latest article</div>
                            </a>
                            <a href="#" class="options w-inline-block">
                              <div data-val="option-value">Read me a short story</div>
                            </a>
                            <a href="#" class="options w-inline-block">
                              <div data-val="option-value">Write a friendly mail</div>
                            </a>
                          </div>
                        </form>
                        <div class="w-form-done">
                          <div>Thank you! Your submission has been received!</div>
                        </div>
                        <div class="w-form-fail">
                          <div>Oops! Something went wrong while submitting the form.</div>
                        </div>
                      </div>
                    </div>
                    <div class="shell_footer">
                      <div class="shell_footer-container">
                        <div class="footer_wrapper">
                          <div class="footer_links">
                            <a href="#" class="footer_link">Blog</a>
                            <a href="#" class="footer_link">About Us</a>
                          </div>
                          <div>Mindspark can make mistakes. Check important info.</div>
                          <div class="footer_links">
                            <a href="#" class="footer_link">Github</a>
                            <a href="#" class="footer_link">X</a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div data-el="shell-secondary" class="shell-secondary">
                    <div data-element="chat-title" class="shell_header">
                      <div data-el="chat-header">Untitled</div>
                    </div>
                    <div class="shell_scroller">
                      <div class="container-medium">
                        <div data-el="chat-block" class="chat-block">
                          <div data-el="user-message" class="chat-item">
                            <div data-el="message-text">This is some text inside of a div block.</div>
                          </div>
                          <div data-el="response-wrapper" class="response">
                            <div data-el="sources-block" class="sources-block">
                              <div class="block_header"><svg xmlns="http://www.w3.org/2000/svg" width="100%" viewbox="0 0 16 16" fill="none" class="icon-1">
                                  <path d="M14.4285 6.82832L10.5735 5.42645L9.17158 1.57145C9.08414 1.33086 8.92477 1.12302 8.71512 0.976147C8.50547 0.829275 8.25569 0.750488 7.99971 0.750488C7.74373 0.750488 7.49395 0.829275 7.28429 0.976147C7.07464 1.12302 6.91527 1.33086 6.82783 1.57145L5.42596 5.42645L1.57096 6.82832C1.33037 6.91576 1.12253 7.07513 0.975659 7.28478C0.828786 7.49444 0.75 7.74421 0.75 8.0002C0.75 8.25618 0.828786 8.50595 0.975659 8.71561C1.12253 8.92526 1.33037 9.08463 1.57096 9.17207L5.42596 10.5739L6.82783 14.4289C6.91527 14.6695 7.07464 14.8774 7.28429 15.0242C7.49395 15.1711 7.74373 15.2499 7.99971 15.2499C8.25569 15.2499 8.50547 15.1711 8.71512 15.0242C8.92477 14.8774 9.08414 14.6695 9.17158 14.4289L10.5735 10.5739L14.4285 9.17207C14.669 9.08463 14.8769 8.92526 15.0238 8.71561C15.1706 8.50595 15.2494 8.25618 15.2494 8.0002C15.2494 7.74421 15.1706 7.49444 15.0238 7.28478C14.8769 7.07513 14.669 6.91576 14.4285 6.82832ZM9.95033 9.20332C9.77888 9.26546 9.62317 9.36451 9.49422 9.49346C9.36527 9.62241 9.26622 9.77812 9.20408 9.94957L7.99971 13.2621L6.79533 9.94957C6.73319 9.77812 6.63414 9.62241 6.50519 9.49346C6.37624 9.36451 6.22053 9.26546 6.04908 9.20332L2.73658 8.0002L6.04908 6.79582C6.22053 6.73368 6.37624 6.63463 6.50519 6.50568C6.63414 6.37673 6.73319 6.22102 6.79533 6.04957L7.99971 2.73707L9.20408 6.04957C9.26622 6.22102 9.36527 6.37673 9.49422 6.50568C9.62317 6.63463 9.77888 6.73368 9.95033 6.79582L13.2628 8.0002L9.95033 9.20332Z" fill="currentColor"></path>
                                </svg>
                                <div>Sources</div>
                              </div>
                              <div data-el="sources-list" class="sources-list">
                                <a data-el="source-card" href="#" class="source-card w-inline-block">
                                  <div data-el="source-title" class="source-title">This is some text inside of a div block.</div>
                                  <div class="source_list">
                                    <div data-el="source-name">Grammarly</div>
                                  </div>
                                </a>
                              </div>
                            </div>
                            <div data-el="thinking-block" class="thinking-block">
                              <div class="thinking_toggle">
                                <div class="bot-logo-wrap"><img src="images/Xs6.png" loading="lazy" sizes="100vw" srcset="images/Xs6-p-500.png 500w, images/Xs6-p-800.png 800w, images/Xs6-p-1080.png 1080w, images/Xs6-p-1600.png 1600w, images/Xs6-p-2000.png 2000w, images/Xs6.png 2048w" alt="" class="u-img-cover"></div><svg xmlns="http://www.w3.org/2000/svg" width="100%" viewbox="0 0 18 18" fill="none" class="icon-1x1">
                                  <path d="M17.7185 10.6875C17.7185 10.9113 17.6296 11.1259 17.4714 11.2841C17.3132 11.4424 17.0986 11.5312 16.8748 11.5312H16.031V12.375C16.031 12.5988 15.9421 12.8134 15.7839 12.9716C15.6257 13.1299 15.4111 13.2188 15.1873 13.2188C14.9635 13.2188 14.7489 13.1299 14.5907 12.9716C14.4324 12.8134 14.3435 12.5988 14.3435 12.375V11.5312H13.4998C13.276 11.5312 13.0614 11.4424 12.9032 11.2841C12.7449 11.1259 12.656 10.9113 12.656 10.6875C12.656 10.4637 12.7449 10.2491 12.9032 10.0909C13.0614 9.93265 13.276 9.84375 13.4998 9.84375H14.3435V9C14.3435 8.77622 14.4324 8.56161 14.5907 8.40338C14.7489 8.24514 14.9635 8.15625 15.1873 8.15625C15.4111 8.15625 15.6257 8.24514 15.7839 8.40338C15.9421 8.56161 16.031 8.77622 16.031 9V9.84375H16.8748C17.0986 9.84375 17.3132 9.93265 17.4714 10.0909C17.6296 10.2491 17.7185 10.4637 17.7185 10.6875ZM3.93728 5.34375H4.78103V6.1875C4.78103 6.41128 4.86992 6.62589 5.02816 6.78412C5.18639 6.94236 5.401 7.03125 5.62478 7.03125C5.84855 7.03125 6.06317 6.94236 6.2214 6.78412C6.37963 6.62589 6.46853 6.41128 6.46853 6.1875V5.34375H7.31228C7.53605 5.34375 7.75067 5.25486 7.9089 5.09662C8.06713 4.93839 8.15603 4.72378 8.15603 4.5C8.15603 4.27622 8.06713 4.06161 7.9089 3.90338C7.75067 3.74514 7.53605 3.65625 7.31228 3.65625H6.46853V2.8125C6.46853 2.58872 6.37963 2.37411 6.2214 2.21588C6.06317 2.05764 5.84855 1.96875 5.62478 1.96875C5.401 1.96875 5.18639 2.05764 5.02816 2.21588C4.86992 2.37411 4.78103 2.58872 4.78103 2.8125V3.65625H3.93728C3.7135 3.65625 3.49889 3.74514 3.34066 3.90338C3.18242 4.06161 3.09353 4.27622 3.09353 4.5C3.09353 4.72378 3.18242 4.93839 3.34066 5.09662C3.49889 5.25486 3.7135 5.34375 3.93728 5.34375ZM12.9373 13.2188H12.656V12.9375C12.656 12.7137 12.5671 12.4991 12.4089 12.3409C12.2507 12.1826 12.0361 12.0938 11.8123 12.0938C11.5885 12.0938 11.3739 12.1826 11.2157 12.3409C11.0574 12.4991 10.9685 12.7137 10.9685 12.9375V13.2188H10.6873C10.4635 13.2188 10.2489 13.3076 10.0907 13.4659C9.93242 13.6241 9.84353 13.8387 9.84353 14.0625C9.84353 14.2863 9.93242 14.5009 10.0907 14.6591C10.2489 14.8174 10.4635 14.9062 10.6873 14.9062H10.9685V15.1875C10.9685 15.4113 11.0574 15.6259 11.2157 15.7841C11.3739 15.9424 11.5885 16.0312 11.8123 16.0312C12.0361 16.0312 12.2507 15.9424 12.4089 15.7841C12.5671 15.6259 12.656 15.4113 12.656 15.1875V14.9062H12.9373C13.1611 14.9062 13.3757 14.8174 13.5339 14.6591C13.6921 14.5009 13.781 14.2863 13.781 14.0625C13.781 13.8387 13.6921 13.6241 13.5339 13.4659C13.3757 13.3076 13.1611 13.2188 12.9373 13.2188ZM15.619 5.82398L5.82306 15.6192C5.55935 15.8828 5.20173 16.0309 4.82884 16.0309C4.45595 16.0309 4.09833 15.8828 3.83462 15.6192L2.37986 14.1652C2.24921 14.0346 2.14558 13.8795 2.07487 13.7089C2.00417 13.5382 1.96777 13.3553 1.96777 13.1706C1.96777 12.9859 2.00417 12.803 2.07487 12.6323C2.14558 12.4617 2.24921 12.3066 2.37986 12.176L12.1758 2.38078C12.4395 2.11715 12.7971 1.96905 13.17 1.96905C13.5429 1.96905 13.9005 2.11715 14.1642 2.38078L15.619 3.83484C15.7496 3.96543 15.8533 4.12048 15.924 4.29113C15.9947 4.46179 16.0311 4.64469 16.0311 4.82941C16.0311 5.01413 15.9947 5.19704 15.924 5.36769C15.8533 5.53835 15.7496 5.69339 15.619 5.82398ZM11.1795 7.875L10.1248 6.82031L3.77204 13.1702L4.82673 14.2249L11.1795 7.875ZM14.2247 4.82977L13.17 3.77508L11.3201 5.625L12.3748 6.67969L14.2247 4.82977Z" fill="currentColor"></path>
                                </svg>
                                <div>Thinking</div><svg xmlns="http://www.w3.org/2000/svg" width="100%" viewbox="0 0 18 18" fill="none" class="icon-1x1 is-arrow">
                                  <path d="M15.2219 11.847C15.1435 11.9256 15.0504 11.988 14.9478 12.0306C14.8453 12.0732 14.7353 12.0951 14.6243 12.0951C14.5132 12.0951 14.4033 12.0732 14.3007 12.0306C14.1981 11.988 14.105 11.9256 14.0266 11.847L8.99997 6.82031L3.97192 11.847C3.81341 12.0055 3.59843 12.0945 3.37427 12.0945C3.1501 12.0945 2.93512 12.0055 2.77661 11.847C2.6181 11.6884 2.52905 11.4735 2.52905 11.2493C2.52905 11.0251 2.6181 10.8101 2.77661 10.6516L8.40161 5.02664C8.48 4.94798 8.57314 4.88557 8.6757 4.84298C8.77826 4.80039 8.88822 4.77847 8.99927 4.77847C9.11032 4.77847 9.22027 4.80039 9.32283 4.84298C9.42539 4.88557 9.51854 4.94798 9.59692 5.02664L15.2219 10.6516C15.3006 10.73 15.363 10.8232 15.4056 10.9257C15.4482 11.0283 15.4701 11.1382 15.4701 11.2493C15.4701 11.3603 15.4482 11.4703 15.4056 11.5729C15.363 11.6754 15.3006 11.7686 15.2219 11.847Z" fill="currentColor"></path>
                                </svg>
                              </div>
                              <div class="thinking-content-panel">
                                <div class="thinking_content">
                                  <p data-el="thinking-text" class="text-color-secondary">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere.Lorem ipsum dolor sit amet, consectetur adipiscing elit. </p>
                                </div>
                                <div data-el="is-thinking" class="loader"></div>
                              </div>
                            </div>
                            <div data-el="response-block" class="thinking-block">
                              <div>
                                <div class="response_content">
                                  <div data-el="message-text" class="response-rte w-richtext">
                                    <h1>Heading 1</h1>
                                    <h2>Heading 2</h2>
                                    <h3>Heading 3</h3>
                                    <h4>Heading 4</h4>
                                    <h5>Heading 5</h5>
                                    <h6 class="heading">Heading 6</h6>
                                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
                                    <blockquote>Block quote</blockquote>
                                    <p>Ordered list</p>
                                    <ol role="list">
                                      <li>Item 1</li>
                                      <li>Item 2</li>
                                      <li>Item 3</li>
                                    </ol>
                                    <p>Unordered list</p>
                                    <ul role="list">
                                      <li>Item A</li>
                                      <li>Item B</li>
                                      <li>Item C</li>
                                    </ul>
                                    <p>
                                      <a href="https://university.webflow.com/lesson/add-and-nest-text-links-in-webflow">Text link</a>
                                    </p>
                                    <p><strong>Bold text</strong></p>
                                    <p><em>Emphasis</em></p>
                                    <p><sup>Superscript</sup></p>
                                    <p><sub>Subscript</sub></p>
                                  </div>
                                </div>
                                <div data-el="is-writing" class="loader"></div>
                              </div>
                            </div>
                            <div data-el="error-block" class="error-block">
                              <div>
                                <div class="error_content">
                                  <p data-el="error-text">error_message</p>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="shell-secondary_input-wrap">
                      <div class="container-medium">
                        <div class="form-block-main w-form">
                          <form id="email-form-3" name="email-form-3" data-name="Email Form 3" method="get" data-wf-page-id="67a7d5201f8561b1ffec5f13" data-wf-element-id="907a20c8-091d-f089-1129-ab0b509a9c21">
                            <div class="input-clear"><textarea class="form-main-input w-input" maxlength="5000" data-el="prompt-sec" name="field" data-name="Field" placeholder="Ask me anythingâ€¦" id="field"></textarea><button data-el="generate-sec" type="button" class="form-button">
                                <div class="icon-1 w-embed"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewbox="0 0 15 14" fill="none">
                                    <path d="M13.1857 6.99411C13.1861 7.15 13.1449 7.30318 13.0662 7.43778C12.9876 7.57239 12.8744 7.68354 12.7384 7.75973L3.5558 13.0103C3.42387 13.0851 3.27488 13.1246 3.12322 13.1251C2.98335 13.1248 2.84559 13.091 2.72149 13.0265C2.59738 12.962 2.49055 12.8687 2.40994 12.7544C2.32933 12.6401 2.2773 12.5082 2.2582 12.3696C2.2391 12.2311 2.25349 12.0899 2.30017 11.9581L3.79587 7.58583C3.81061 7.54257 3.83853 7.50501 3.8757 7.47843C3.91288 7.45185 3.95744 7.43758 4.00314 7.43762H7.93572C7.99569 7.43775 8.05506 7.42555 8.11012 7.40178C8.16518 7.378 8.21477 7.34316 8.25579 7.29941C8.29682 7.25566 8.32842 7.20395 8.34862 7.14748C8.36882 7.091 8.37719 7.03098 8.37322 6.97114C8.3633 6.85864 8.31124 6.75404 8.22748 6.67829C8.14372 6.60253 8.03443 6.56122 7.9215 6.56262H4.00697C3.96134 6.5627 3.91682 6.54851 3.87965 6.52204C3.84249 6.49556 3.81453 6.45812 3.7997 6.41497L2.29908 2.03997C2.24064 1.87232 2.23458 1.69087 2.28171 1.5197C2.32883 1.34853 2.42691 1.19575 2.56292 1.08163C2.69892 0.967522 2.86643 0.897483 3.04318 0.880818C3.21993 0.864152 3.39758 0.901647 3.55252 0.988326L12.74 6.23231C12.8752 6.3084 12.9876 6.41904 13.066 6.5529C13.1443 6.68675 13.1856 6.83902 13.1857 6.99411Z" fill="currentColor"></path>
                                  </svg></div>
                              </button></div>
                          </form>
                          <div class="w-form-done">
                            <div>Thank you! Your submission has been received!</div>
                          </div>
                          <div class="w-form-fail">
                            <div>Oops! Something went wrong while submitting the form.</div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=67a7d5201f8561b1ffec5f14" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>
  <script src="https://unpkg.com/typed.js@2.1.0/dist/typed.umd.js"></script>
  <script>
// Wait for DOM to be fully loaded
document.addEventListener("DOMContentLoaded", function () {
  // Initialize main page elements
  const shellMain = document.querySelector('[data-el="shell-main"]');
  const shellSecond = document.querySelector('[data-el="shell-secondary"]');
  const chatHeader = document.querySelector('[data-el="chat-header"]');
  let isFirstRun = true;
  const optionLinks = document.querySelectorAll('.options');
  const promptInput = document.querySelector('[data-el="prompt"]');
  // Typed.js instance (for animating the chat header)
  let typedInstance = null;
  // Store templates for reuse
  const templates = {
    userMessage: document
      .querySelector('[data-el="user-message"]')
      ?.cloneNode(true),
    responseWrapper: document
      .querySelector('[data-el="response-wrapper"]')
      ?.cloneNode(true),
  };
  // Initialize chat container
  const chatWrapper = document.querySelector('[data-el="chat-block"]');
  chatWrapper.innerHTML = "";
  // API endpoint configuration
  const API_ENDPOINTS = {
    SEARCH: "https://xs6.jamescubn.workers.dev/api/search",
    CHAT_STREAM: "https://xs6.jamescubn.workers.dev/api/completions",
  };
  optionLinks.forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault(); // Prevent default link behavior
      const optionText = e.currentTarget.querySelector('[data-val="option-value"]').textContent;
      // Update both prompt inputs with the option text
      if (promptInput) promptInput.value = optionText;
    });
  });
  // Function to animate the chat header with Typed.js
  function animateChatHeader(text) {
    if (typedInstance) {
      typedInstance.destroy(); // Destroy the existing Typed.js instance if any
    }
    typedInstance = new Typed(chatHeader, {
      strings: [text], // Text to display
      typeSpeed: 50, // Typing speed in milliseconds
      startDelay: 300, // Delay before starting the animation
      showCursor: false, // Hide the blinking cursor
    });
  }
  // Function to create and add a new message to the chat
  function addNewMessage(promptText) {
    const chatBlock = document.querySelector('[data-el="chat-block"]');
    if (!chatBlock || !templates.userMessage || !templates.responseWrapper)
      return null;
    // Set up user message
    const newUserMessage = templates.userMessage.cloneNode(true);
    const messageText = newUserMessage.querySelector(
      '[data-el="message-text"]'
    );
    if (messageText) {
      messageText.textContent = promptText;
    }
    // Set up response container
    const newResponseWrapper = templates.responseWrapper.cloneNode(true);
    // Initially hide all response blocks
    const sourcesBlock = newResponseWrapper.querySelector(
      '[data-el="sources-block"]'
    );
    const thinkingBlock = newResponseWrapper.querySelector(
      '[data-el="thinking-block"]'
    );
    const responseBlock = newResponseWrapper.querySelector(
      '[data-el="response-block"]'
    );
    if (sourcesBlock) sourcesBlock.style.display = "none";
    if (thinkingBlock) thinkingBlock.style.display = "none";
    if (responseBlock) responseBlock.style.display = "none";
    // Add to chat
    chatBlock.appendChild(newUserMessage);
    chatBlock.appendChild(newResponseWrapper);
    return {
      responseWrapper: newResponseWrapper,
      sourcesBlock,
      thinkingBlock,
      responseBlock,
    };
  }
  // Helper function to extract and format company name from URL
  function getCompanyNameFromURL(url) {
    try {
      // Create URL object to parse the domain
      const urlObject = new URL(url);
      // Get the hostname (e.g., "evaboot.com" from "https://evaboot.com/blog/...")
      let domain = urlObject.hostname;
      // Remove 'www.' if present
      domain = domain.replace("www.", "");
      // Split by dots and get the main domain name
      const parts = domain.split(".");
      const mainDomain = parts[0];
      // Convert domain name to title case and clean up
      // For example: "evaboot" becomes "Evaboot"
      const companyName = mainDomain
        .split("-")
        .map(
          (word) => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
        )
        .join(" ");
      return companyName;
    } catch (error) {
      console.error("Error parsing URL:", error);
      return "Unknown Source";
    }
  }
  // Function to display search sources
  function displaySources(responseWrapper, sources) {
    const sourcesList = responseWrapper.querySelector(
      '[data-el="sources-list"]'
    );
    const sourcesBlock = responseWrapper.querySelector(
      '[data-el="sources-block"]'
    );
    if (!sourcesList || !sourcesBlock) return false;
    try {
      const sourceCardTemplate = responseWrapper.querySelector(
        '[data-el="source-card"]'
      );
      sourcesList.innerHTML = "";
      if (!sourceCardTemplate) return false;
      sources.forEach((source) => {
        const sourceCard = sourceCardTemplate.cloneNode(true);
        const titleEl = sourceCard.querySelector('[data-el="source-title"]');
        const nameEl = sourceCard.querySelector('[data-el="source-name"]');
        if (titleEl) {
          titleEl.textContent = source.title;
        }
        if (nameEl && source.url) {
          // Get company name from URL and set it as the source name
          const companyName = getCompanyNameFromURL(source.url);
          nameEl.textContent = companyName;
          // Make the entire source card clickable
          sourceCard.href = source.url;
          sourceCard.target = "_blank"; // Open in new tab
          sourceCard.rel = "noopener noreferrer"; // Security best practice
        }
        sourcesList.appendChild(sourceCard);
      });
      sourcesBlock.style.display = "block";
      return true;
    } catch (error) {
      console.error("Error displaying sources:", error);
      return false;
    }
  }
  // Handler function for thinking and response states
  function handleThinkingAndResponse(responseWrapper) {
    const thinkingBlock = responseWrapper.querySelector(
      '[data-el="thinking-block"]'
    );
    const thinkingText = thinkingBlock?.querySelector(
      '[data-el="thinking-text"]'
    );
    const thinkingLoader = thinkingBlock?.querySelector(
      '[data-el="is-thinking"]'
    );
    const responseBlock = responseWrapper.querySelector(
      '[data-el="response-block"]'
    );
    const responseText = responseBlock?.querySelector(
      '[data-el="message-text"]'
    );
    const responseLoader = responseBlock?.querySelector(
      '[data-el="is-writing"]'
    );
    const errorBlock = responseWrapper.querySelector('[data-el="error-block"]');
    const errorText = errorBlock?.querySelector('[data-el="error-text"]');
    if (
      !thinkingBlock ||
      !thinkingText ||
      !responseBlock ||
      !responseText ||
      !errorBlock
    ) {
      console.error("Required elements not found in response wrapper");
      return {
        showThinkingState: () => {},
        updateThinking: () => {},
        updateResponse: () => {},
        showError: () => {},
      };
    }
    // Initially hide all blocks and loaders
    thinkingBlock.style.display = "none";
    responseBlock.style.display = "none";
    errorBlock.style.display = "none";
    if (thinkingLoader) thinkingLoader.style.display = "none";
    if (responseLoader) responseLoader.style.display = "none";
    // Clear existing content
    thinkingText.textContent = "";
    responseText.innerHTML = "";
    errorText.innerHTML = "";
    responseText.classList.add("w-richtext");
    let hasStartedResponse = false;
    // Add event listener for the thinking toggle
    const thinkingToggle = thinkingBlock.querySelector(".thinking_toggle");
    if (thinkingToggle) {
      thinkingToggle.addEventListener("click", function () {
        thinkingBlock.classList.toggle("is-collapsed");
      });
    }
    return {
      showThinkingState: () => {
        errorBlock.style.display = "none";
        responseBlock.style.display = "none";
        thinkingBlock.style.display = "flex";
        if (thinkingLoader) thinkingLoader.style.display = "block";
      },
      updateThinking: (content) => {
        thinkingText.textContent += content;
        thinkingBlock.scrollTop = thinkingBlock.scrollHeight;
      },
      updateResponse: (htmlContent) => {
        if (!hasStartedResponse) {
          if (thinkingLoader) thinkingLoader.style.display = "none";
          responseBlock.style.display = "block";
          if (responseLoader) responseLoader.style.display = "block";
          hasStartedResponse = true;
        }
        responseText.innerHTML = htmlContent;
        // Add Webflow-specific styling
        responseText
          .querySelectorAll("h1")
          .forEach((h1) => h1.classList.add("heading-1"));
        responseText
          .querySelectorAll("h2")
          .forEach((h2) => h2.classList.add("heading-2"));
        responseText
          .querySelectorAll("h3")
          .forEach((h3) => h3.classList.add("heading-3"));
        responseText
          .querySelectorAll("p")
          .forEach((p) => p.classList.add("paragraph"));
        responseText
          .querySelectorAll("ul")
          .forEach((ul) => ul.setAttribute("role", "list"));
        responseText
          .querySelectorAll("ol")
          .forEach((ol) => ol.setAttribute("role", "list"));
        responseText
          .querySelectorAll("blockquote")
          .forEach((quote) => quote.classList.add("block-quote"));
        responseBlock.scrollTop = responseBlock.scrollHeight;
      },
      showError: (errorMessage) => {
        thinkingBlock.style.display = "none";
        responseBlock.style.display = "none";
        if (thinkingLoader) thinkingLoader.style.display = "none";
        if (responseLoader) responseLoader.style.display = "none";
        errorBlock.style.display = "block";
        errorText.innerHTML = errorMessage;
      },
    };
  }
  async function performSearch(query) {
    try {
      const response = await fetch(API_ENDPOINTS.SEARCH, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ query }),
      });
      if (!response.ok) throw new Error("Search failed");
      const data = await response.json();
      return data.results;
    } catch (error) {
      console.error("Search error:", error);
      throw error;
    }
  }
  // Function to handle streaming response
  async function streamChatResponse(
    query,
    sources,
    responseWrapper,
    handlers
  ) {
    let buffer = "";
    let accumulatedResponse = "";
    let hasReceivedAnyContent = false;
    let timeoutId = null;
    const customMarkedRenderer = new marked.Renderer();
    customMarkedRenderer.hr = () => "";
    try {
      // Show thinking state when making the call
      handlers.showThinkingState();
      const response = await fetch(API_ENDPOINTS.CHAT_STREAM, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ query, sources }),
      });
      // Check for errors in the response
      if (!response.ok) {
        const errorData = await response.json();
        throw new Error(
          errorData.content || "An error occurred. Please try again."
        );
      }
      const reader = response.body.getReader();
      const decoder = new TextDecoder();
      // Create a promise that will reject after 30 seconds
      const timeoutPromise = new Promise((_, reject) => {
        timeoutId = setTimeout(() => {
          reject(new Error("No response received from server"));
        }, 30000);
      });
      // Process the stream
      const streamPromise = (async () => {
        while (true) {
          const { value, done } = await reader.read();
          if (done) break;
          buffer += decoder.decode(value);
          const lines = buffer.split("\n");
          buffer = lines.pop() || "";
          for (const line of lines) {
            if (!line.trim()) continue;
            try {
              const { type, content } = JSON.parse(line);
              // Clear timeout on first content received
              if (!hasReceivedAnyContent && timeoutId) {
                clearTimeout(timeoutId);
                timeoutId = null;
              }
              hasReceivedAnyContent = true;
              // if (type === 'thinking') {
              //   handlers.updateThinking(content);
              // } else if (type === 'response') {
              //   accumulatedResponse += content;
              //   const formattedHtml = marked.parse(accumulatedResponse, {
              //     breaks: true,
              //     gfm: true,
              //     renderer: customMarkedRenderer
              //   });
              //   handlers.updateResponse(formattedHtml);
              // }
              if (type === "error") {
                throw new Error(content); // Propagate server error message
              } else if (type === "thinking") {
                handlers.updateThinking(content);
              } else if (type === "response") {
                accumulatedResponse += content;
                const formattedHtml = marked.parse(accumulatedResponse, {
                  breaks: true,
                  gfm: true,
                  renderer: customMarkedRenderer,
                });
                handlers.updateResponse(formattedHtml);
              }
            } catch (e) {
              console.error("Error parsing stream chunk:", e);
              handlers.showError(e.message);
            }
          }
        }
        if (!hasReceivedAnyContent) {
          throw new Error("Received empty response from server");
        }
      })();
      // Wait for either timeout or stream completion
      await Promise.race([streamPromise, timeoutPromise]);
      // Final formatting pass if we received content
      if (accumulatedResponse) {
        const finalHtml = marked.parse(accumulatedResponse, {
          breaks: true,
          gfm: true,
          renderer: customMarkedRenderer, // Add this line
        });
        handlers.updateResponse(finalHtml);
      }
      // Don't hide the thinking block anymore
      const responseLoader = responseWrapper.querySelector(
        '[data-el="is-writing"]'
      );
      if (responseLoader) responseLoader.style.display = "none";
    } catch (error) {
      console.error("Streaming error:", error);
      let errorMessage = "An error occurred. Please try again.";
      if (error.message === "No response received from server") {
        errorMessage = "Server is busy. Please try again in a few moments.";
      } else if (error.message === "Received empty response from server") {
        errorMessage = "Server returned an empty response. Please try again.";
      } else if (!navigator.onLine) {
        errorMessage = "Please check your internet connection and try again.";
      }
      handlers.showError(errorMessage);
    } finally {
      // Clean up timeout if it's still active
      if (timeoutId) {
        clearTimeout(timeoutId);
      }
    }
  }
  // Set up event listeners for generate buttons
  ["generate", "generate-sec"].forEach((buttonId) => {
    const generateButton = document.querySelector(`[data-el="${buttonId}"]`);
    const promptInput = document.querySelector(
      `[data-el="${buttonId === "generate" ? "prompt" : "prompt-sec"}"]`
    );
    if (generateButton && promptInput) {
      generateButton.addEventListener("click", async function () {
        const promptText = promptInput.value.trim();
        if (!promptText) return;
        if (isFirstRun) {
          shellMain.style.display = "none";
          shellSecond.style.display = "flex";
          isFirstRun = false;
          // Animate the chat header with the first prompt
          animateChatHeader(promptText);
        }
        promptInput.value = "";
        const elements = addNewMessage(promptText);
        if (!elements) return;
        try {
          // Get handlers and show initial thinking state
          const handlers = handleThinkingAndResponse(elements.responseWrapper);
          // handlers.showThinkingState();
          // Perform search and display results
          const searchResults = await performSearch(promptText);
          const sourcesDisplayed = displaySources(
            elements.responseWrapper,
            searchResults
          );
          if (sourcesDisplayed) {
            // Stream and process response
            await streamChatResponse(
              promptText,
              searchResults,
              elements.responseWrapper,
              handlers
            );
          }
        } catch (error) {
          console.error("Error in processing:", error);
          const handlers = handleThinkingAndResponse(elements.responseWrapper);
          handlers.showError(
            "An error occurred while processing your request. Please try again."
          );
        }
      });
      // Add keydown event listener to the prompt input field
      promptInput.addEventListener("keydown", function (event) {
        if (event.key === "Enter") {
          event.preventDefault(); // Prevent the form from being submitted
          generateButton.click(); // Trigger the click event on the generate button
        }
      });
    }
  });
});
</script>
</body>
</html>